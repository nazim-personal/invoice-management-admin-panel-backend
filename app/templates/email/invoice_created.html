{% extends "email/base.html" %}

{% block title %}Invoice Created{% endblock %}

{% block content %}
<p>Dear {{ customer.name }},</p>
<p>A new invoice <strong>#{{ invoice.invoice_number }}</strong> has been created for you.</p>

<h3 style="margin-top: 30px; margin-bottom: 10px; color: #333;">Invoice Details</h3>
<table style="width: 100%; border-collapse: collapse; margin-bottom: 20px;">
    <tr>
        <td style="padding: 8px; border-bottom: 1px solid #ddd;"><strong>Invoice Number:</strong></td>
        <td style="padding: 8px; border-bottom: 1px solid #ddd;">{{ invoice.invoice_number }}</td>
    </tr>
    <tr>
        <td style="padding: 8px; border-bottom: 1px solid #ddd;"><strong>Invoice Date:</strong></td>
        <td style="padding: 8px; border-bottom: 1px solid #ddd;">{{ invoice.created_at }}</td>
    </tr>
    <tr>
        <td style="padding: 8px; border-bottom: 1px solid #ddd;"><strong>Due Date:</strong></td>
        <td style="padding: 8px; border-bottom: 1px solid #ddd;">{{ invoice.due_date }}</td>
    </tr>
    <tr>
        <td style="padding: 8px; border-bottom: 1px solid #ddd;"><strong>Status:</strong></td>
        <td style="padding: 8px; border-bottom: 1px solid #ddd;"><span
                style="background-color: #ffc107; padding: 4px 8px; border-radius: 3px; font-size: 0.9em;">{{
                invoice.status }}</span></td>
    </tr>
</table>

{% if invoice.invoice_items %}
<h3 style="margin-top: 30px; margin-bottom: 10px; color: #333;">Items</h3>
<table style="width: 100%; border-collapse: collapse; margin-bottom: 20px; border: 1px solid #ddd;">
    <thead>
        <tr style="background-color: #f8f9fa;">
            <th style="padding: 10px; text-align: left; border-bottom: 2px solid #ddd;">Item</th>
            <th style="padding: 10px; text-align: center; border-bottom: 2px solid #ddd;">Quantity</th>
            <th style="padding: 10px; text-align: right; border-bottom: 2px solid #ddd;">Price</th>
            <th style="padding: 10px; text-align: right; border-bottom: 2px solid #ddd;">Total</th>
        </tr>
    </thead>
    <tbody>
        {% for item in invoice.invoice_items %}
        <tr>
            <td style="padding: 10px; border-bottom: 1px solid #eee;">{{ item.product_name or 'Product' }}</td>
            <td style="padding: 10px; text-align: center; border-bottom: 1px solid #eee;">{{ item.quantity }}</td>
            <td style="padding: 10px; text-align: right; border-bottom: 1px solid #eee;">₹{{ "%.2f"|format(item.price)
                }}</td>
            <td style="padding: 10px; text-align: right; border-bottom: 1px solid #eee;">₹{{ "%.2f"|format(item.total)
                }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endif %}

</table>

{% if invoice.initial_payment %}
<h3 style="margin-top: 30px; margin-bottom: 10px; color: #333;">Payment Received</h3>
<table
    style="width: 100%; border-collapse: collapse; margin-bottom: 20px; background-color: #f8f9fa; border: 1px solid #ddd;">
    <tr>
        <td style="padding: 12px; border-bottom: 1px solid #ddd;"><strong>Amount Paid:</strong></td>
        <td style="padding: 12px; border-bottom: 1px solid #ddd; color: #28a745;"><strong>₹{{
                "%.2f"|format(invoice.initial_payment.amount) }}</strong></td>
    </tr>
    <tr>
        <td style="padding: 12px; border-bottom: 1px solid #ddd;"><strong>Payment Date:</strong></td>
        <td style="padding: 12px; border-bottom: 1px solid #ddd;">{{ invoice.initial_payment.date }}</td>
    </tr>
    <tr>
        <td style="padding: 12px; border-bottom: 1px solid #ddd;"><strong>Payment Method:</strong></td>
        <td style="padding: 12px; border-bottom: 1px solid #ddd; text-transform: capitalize;">{{
            invoice.initial_payment.method }}</td>
    </tr>
</table>
{% endif %}

<h3 style="margin-top: 30px; margin-bottom: 10px; color: #333;">Summary</h3>
<table style="width: 100%; border-collapse: collapse; margin-bottom: 20px;">
    <tr>
        <td style="padding: 8px; text-align: right;"><strong>Subtotal:</strong></td>
        <td style="padding: 8px; text-align: right; width: 150px;">₹{{ "%.2f"|format(invoice.subtotal_amount) }}</td>
    </tr>
    {% if invoice.discount_amount > 0 %}
    <tr>
        <td style="padding: 8px; text-align: right; color: #28a745;"><strong>Discount:</strong></td>
        <td style="padding: 8px; text-align: right; color: #28a745;">- ₹{{ "%.2f"|format(invoice.discount_amount) }}
        </td>
    </tr>
    {% endif %}
    {% if invoice.tax_percent > 0 %}
    <tr>
        <td style="padding: 8px; text-align: right;"><strong>Tax ({{ invoice.tax_percent }}%):</strong></td>
        <td style="padding: 8px; text-align: right;">₹{{ "%.2f"|format(invoice.tax_amount) }}</td>
    </tr>
    {% endif %}
    <tr>
        <td style="padding: 12px; text-align: right; font-size: 1.1em;"><strong>Total Amount:</strong></td>
        <td style="padding: 12px; text-align: right; font-size: 1.1em;">₹{{ "%.2f"|format(invoice.total_amount) }}</td>
    </tr>
    {% if invoice.initial_payment %}
    <tr>
        <td style="padding: 8px; text-align: right; color: #28a745;"><strong>Amount Paid:</strong></td>
        <td style="padding: 8px; text-align: right; color: #28a745;">- ₹{{ "%.2f"|format(invoice.initial_payment.amount)
            }}</td>
    </tr>
    <tr style="border-top: 2px solid #333;">
        <td style="padding: 12px; text-align: right; font-size: 1.2em;"><strong>Balance Due:</strong></td>
        <td
            style="padding: 12px; text-align: right; font-size: 1.2em; color: {% if invoice.due_amount > 0 %}#dc3545{% else %}#28a745{% endif %};">
            <strong>₹{{ "%.2f"|format(invoice.due_amount) }}</strong>
        </td>
    </tr>
    {% else %}
    <tr style="border-top: 2px solid #333;">
        <td style="padding: 12px; text-align: right; font-size: 1.2em;"><strong>Total Due:</strong></td>
        <td style="padding: 12px; text-align: right; font-size: 1.2em; color: #007bff;"><strong>₹{{
                "%.2f"|format(invoice.total_amount) }}</strong></td>
    </tr>
    {% endif %}
</table>

<p style="margin-top: 30px;">Please review the invoice details and make the payment by <strong>{{ invoice.due_date
        }}</strong>.</p>

<p>Thank you for your business!</p>
{% endblock %}